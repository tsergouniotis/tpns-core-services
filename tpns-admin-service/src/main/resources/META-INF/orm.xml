<?xml version="1.0" encoding="UTF-8"?>
<entity-mappings xmlns="http://xmlns.jcp.org/xml/ns/persistence/orm"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/persistence/orm http://www.oracle.com/webfolder/technetwork/jsc/xml/ns/persistence/orm_2_1.xsd"
	version="2.1">

	<persistence-unit-metadata>
		<xml-mapping-metadata-complete />
		<persistence-unit-defaults>
			<cascade-persist />
		</persistence-unit-defaults>
	</persistence-unit-metadata>

	<entity class="com.tpns.admin.domain.Property">
		<table name="properties" />
		<named-query name="Property.findByPropertyIds">
			<query>SELECT p from Property p where p.propertyId in (:propertyIds)</query>
		</named-query>
		<attributes>
			<id name="id" access="FIELD">
				<column name="database_id" />
				<generated-value strategy="SEQUENCE" generator="PROPERTYSEQ" />
				<sequence-generator name="PROPERTYSEQ"
					sequence-name="PROPERTYSEQ" allocation-size="1" />
			</id>
			<basic name="propertyId">
				<column name="property_id" length="255" unique="true" />
			</basic>
			<basic name="url">
				<column name="url" length="255" unique="true" />
			</basic>
			<basic name="description">
				<column name="property_desc" length="255" />
			</basic>
		</attributes>
	</entity>

	<entity class="com.tpns.domain.article.Article" name="Article"
		cacheable="true" access="FIELD">
		<table name="articles" />
		<attributes>
			<id name="id">
				<column name="database_id" />
				<generated-value strategy="SEQUENCE" generator="ARTICLESEQ" />
				<sequence-generator name="ARTICLESEQ"
					sequence-name="ARTICLESEQ" allocation-size="1" />
			</id>
			<basic name="guid">
				<column name="guid" insertable="false" updatable="false" />
			</basic>
			<basic name="author">
				<column name="author" />
			</basic>
			<basic name="headline">
				<column name="headline" length="255" />
			</basic>
			<basic name="subHead">
				<column name="sub_head" length="255" />
			</basic>
			<basic name="content">
				<column name="content" length="8096" />
			</basic>
			<basic name="status">
				<column name="status" length="50" />
				<enumerated>STRING</enumerated>
			</basic>

			<basic name="createdAt">
				<column name="created_at" nullable="false" insertable="false"
					updatable="false" />
			</basic>
			<basic name="updatedAt">
				<column name="updated_at" />
			</basic>
			<basic name="postedAt">
				<column name="posted_at" />
			</basic>

			<version name="version" />

			<element-collection name="resources">
				<collection-table name="article_resources">
					<join-column name="article_sid" />
				</collection-table>
			</element-collection>

			<embedded name="kicker">
				<attribute-override name="text">
					<column name="kicker_text" />
				</attribute-override>
				<attribute-override name="image">
					<column name="kicker_image_url" />
				</attribute-override>
				<attribute-override name="settings">
					<column name="kicker_image_settings" />
				</attribute-override>
			</embedded>
			<embedded name="nutshell">
				<attribute-override name="text">
					<column name="nutshell_text" />
				</attribute-override>
				<attribute-override name="image">
					<column name="nutshell_image_url" />
				</attribute-override>
				<attribute-override name="settings">
					<column name="nutshell_image_settings" />
				</attribute-override>
			</embedded>
			<embedded name="lead" />
			<!-- For some reason the Hibernate need the attributes to be overriden 
				here too -->
			<embedded name="billboard"/>
			<transient name="owner"/>
			<transient name="destinations" />
			<transient name="audits" />
			<transient name="categories" />
			<transient name="keywords" />
		</attributes>
	</entity>

	<entity class="com.tpns.admin.domain.ArticleDistributionReport"
		access="FIELD">
		<table name="article_distribution_report" />
		<attributes>
			<embedded-id name="id" />
			<basic name="status">
				<column name="processing_result" />
			</basic>
			<basic name="createdAt">
				<column name="created_at" insertable="false" updatable="false" />
			</basic>

		</attributes>
	</entity>

	<embeddable class="com.tpns.admin.domain.ArticleDistributionId">
		<attributes>
			<basic name="articleGuid">
				<column name="article_guid" />
			</basic>
			<basic name="destination">
				<column name="destination" />
			</basic>
		</attributes>
	</embeddable>

	<embeddable class="com.tpns.domain.article.Lead">
		<attributes>
			<basic name="soft">
				<column name="soft_lead" />
			</basic>
			<basic name="hard">
				<column name="hard_lead" />
			</basic>
		</attributes>
	</embeddable>

	<embeddable class="com.tpns.domain.article.Billboard"
		access="PROPERTY">
		<attributes>
			<basic name="text">
				<column name="billboard_text" />
			</basic>
			<basic name="image">
				<column name="billboard_image_url" />
			</basic>
			<basic name="settings">
				<column name="billboard_image_settings" />
			</basic>
			<transient name="articleId" />
			<transient name="article" />
			<transient name="info"/>
		</attributes>
	</embeddable>

	<embeddable class="com.tpns.domain.article.ArticleInfo">
		<attributes>
			<basic name="text">
				<column name="content_text" />
			</basic>
			<basic name="image">
				<column name="image_url" />
			</basic>
			<basic name="settings">
				<column name="image_settings" />
				<enumerated>STRING</enumerated>
			</basic>
		</attributes>
	</embeddable>

	<embeddable class="com.tpns.domain.article.MediaResource">
		<attributes>
			<basic name="type">
				<column name="resource_type" length="50" />
			</basic>
			<basic name="url">
				<column name="url" length="2048" />
			</basic>
			<transient name="id" />
		</attributes>
	</embeddable>

	<converter
		class="com.tpns.jpa.common.converters.LocalDateTimeAttributeConverter"
		auto-apply="true" />

	<!-- <converter class="com.tpns.jpa.postgres.converters.UUIDConverter" auto-apply="true" 
		/> -->

</entity-mappings>